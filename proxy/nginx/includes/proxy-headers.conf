# ============================================================================
# Proxy Headers
# ============================================================================
# Standard proxy headers for reverse proxying to backend services.
# This configuration includes all necessary headers for proper proxying,
# including support for WebSockets, API authentication, and streaming.
# Include this file in location blocks with: include /etc/nginx/includes/proxy-headers.conf;
# ============================================================================

# HTTP protocol version for backend connections
proxy_http_version 1.1;

# WebSocket support
proxy_set_header Upgrade    $http_upgrade;
proxy_set_header Connection "upgrade";

# Disable automatic redirects rewriting
proxy_redirect off;

# Disable response buffering (better for streaming photos/videos/documents)
proxy_buffering off;

# Forward original host information (including port for correct redirects)
proxy_set_header Host              $host:$server_port;
proxy_set_header X-Forwarded-Host  $server_name;
proxy_set_header X-Forwarded-Port  $server_port;

# Forward client IP information
proxy_set_header X-Real-IP         $remote_addr;
proxy_set_header X-Forwarded-For   $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;

# Forward authorization headers (needed for API authentication and mobile apps)
proxy_set_header Authorization     $http_authorization;
proxy_pass_header Authorization;
