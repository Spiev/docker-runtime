# ============================================================================
# Home Assistant HTTP Integration für Reverse Proxy
# ============================================================================
# Diese Konfiguration muss in Ihre configuration.yaml auf dem Raspberry Pi
# eingefügt werden.
#
# WICHTIG: Ersetzen Sie IHRE_DOMAIN4 mit Ihrer tatsächlichen Domain!
#
# Deployment-Anleitung:
# 1. SSH in Ihren Raspberry Pi
# 2. Öffnen Sie die configuration.yaml:
#    nano ~/docker/homeassistant/homeassistant/config/configuration.yaml
# 3. Fügen Sie die http-Konfiguration unten ein
# 4. Home Assistant neu starten:
#    cd ~/docker/homeassistant && docker compose restart homeassistant
# ============================================================================

http:
  # Reverse Proxy Konfiguration
  use_x_forwarded_for: true
  trusted_proxies:
    - 172.16.0.0/12       # Docker bridge network
    - 192.168.178.0/24    # Local network (adjust if different)
    - 127.0.0.1           # Localhost

  # CORS Einstellungen (für externe Apps)
  cors_allowed_origins:
    - https://IHRE_DOMAIN4  # WICHTIG: Ersetzen Sie dies mit Ihrer tatsächlichen DOMAIN4!

  # IP Ban Einstellungen (zusätzlich zu Fail2ban)
  ip_ban_enabled: true
  login_attempts_threshold: 5


# ============================================================================
# OPTIONAL: 2FA (Zwei-Faktor-Authentifizierung) aktivieren
# ============================================================================
# 2FA wird in der Home Assistant UI konfiguriert, nicht in configuration.yaml:
#
# 1. Öffnen Sie Home Assistant
# 2. Gehen Sie zu Profil (unten links, klicken Sie auf Ihren Namen)
# 3. Scrollen Sie nach unten zu "Zwei-Faktor-Authentifizierung"
# 4. Klicken Sie "Aktivieren" und scannen Sie den QR-Code mit einer
#    Authenticator-App (z.B. Google Authenticator, Authy, 1Password)
# 5. Geben Sie den 6-stelligen Code ein, um 2FA zu aktivieren
#
# EMPFEHLUNG: Aktivieren Sie 2FA für alle Benutzer!
# ============================================================================


# ============================================================================
# OPTIONAL: Logs für Authentifizierung aktivieren (für Debugging)
# ============================================================================
# Hilfreich zum Testen der Reverse Proxy Integration und für Fail2ban
logger:
  default: info
  logs:
    homeassistant.components.http: debug
    homeassistant.components.http.ban: warning
