# Fail2Ban filter for malicious URI patterns
# ============================================================================
# Matches requests for common attack vectors regardless of HTTP status code
# Attackers probing for vulnerabilities often get 200/301 on some paths
#
# Catches:
# - WordPress attacks (wp-admin, wp-login, xmlrpc.php)
# - Database admin tools (phpmyadmin, mysql, adminer)
# - Config file exposure (.env, .git, config, backup)
# - Shell/backdoor attempts (shell, setup, install)
# ============================================================================

[Definition]

# Match malicious URIs regardless of status code
# These paths should never be accessed on a legitimate homelab
failregex = ^<HOST> -.*"(?:GET|POST|HEAD) /[^"]*(?:phpmyadmin|phpadmin|pma|admin|mysql|database|\.env|wp-login|wp-admin|shell|config|backup|setup|install|xmlrpc\.php|\.git).*".*$

# No ignore patterns - all matches are suspicious
ignoreregex =
