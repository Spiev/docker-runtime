# Fail2Ban filter for Nginx rate limiting violations
# Matches 503 Service Unavailable responses (typically from rate limiting)
#
# When Nginx rate limiting kicks in, it returns 503. Multiple 503s indicate
# an attacker or aggressive bot trying to overwhelm the server.

[Definition]

# Match 503 Service Unavailable (rate limit exceeded)
# Format: IP - - [timestamp] "METHOD /path HTTP/version" 503 size "referer" "user-agent"
failregex = ^<HOST> - .* - \[[^\]]+\] "(?:GET|POST|PUT|DELETE|PATCH|HEAD) .* HTTP/[0-9.]+" 503 \d+

# Ignore legitimate status codes
ignoreregex =
