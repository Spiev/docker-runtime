# Fail2Ban filter for Nginx scanning/probing attempts
# Matches 403 Forbidden and 404 Not Found for suspicious paths
#
# Attackers often scan for common vulnerabilities (WordPress, phpMyAdmin, etc.)
# Multiple 403/404 responses indicate reconnaissance activity

[Definition]

# Match 403 Forbidden or 404 Not Found for suspicious paths
# Common attack vectors: wp-admin, phpMyAdmin, .env, .git, admin panels
failregex = ^<HOST> - .* - \[[^\]]+\] "(?:GET|POST|HEAD) .*(wp-admin|wp-login|phpMyAdmin|phpmyadmin|\.env|\.git|admin|administrator|config|backup|\.sql|\.zip|xmlrpc\.php).* HTTP/[0-9.]+" (403|404) \d+

# Ignore legitimate 404s on common paths (favicons, robots.txt, etc.)
ignoreregex = ^<HOST> .* "(GET|HEAD) /(favicon\.ico|robots\.txt|apple-touch-icon|site\.webmanifest) HTTP
